<!DOCTYPE html PUBLIC
        "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- (c) Copyright 2016 SailPoint Technologies, Inc., All Rights Reserved. -->

<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:sp="http://sailpoint.com/ui"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:c="http://java.sun.com/jstl/core"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:t="http://myfaces.apache.org/tomahawk">

<head>
<title>GeoMap plugin</title>
</head>
<body>


<ui:composition>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyAINinHSMi1pUMLz3SyNtraGexa2yaHK3A"></script>

    <sp:style
            serveOffset="#{base.requestContextPath}/#{pluginFramework.pluginFolderName}/#{pluginFramework.uniqueName}/ui/css">
        <!--<src>ng-modalDialog.css?#{debug.revision}</src>-->
    </sp:style>

    <div id="hello"></div>
    <h1> TEST </h1>
    <sp:script enabled="false"
               serveOffset="#{base.requestContextPath}/#{pluginFramework.pluginFolderName}/#{pluginFramework.uniqueName}/ui/js">
        <src>ipmapper.js</src>
        <src>queryMap.js</src>
        </sp:script>


        <script type="text/javascript">
            $(document).ready(function(){
                try{
                    IPMapper.initializeMap("map");
//                    Console.log(get_location());
                    var g = get_location(setter);
                    function setter (msg){

                        msg.forEach(function(entry) {
                            console.log(entry + " from within ");
                            try {
                                IPMapper.addIPMarker(entry);
                            }catch(err){
                                console.log("bad ip " + err);
                            }
                        });
                    }
                } catch(e){
                    console.log(e);
                }
            });

           function search_name(val){
                try{
                    IPMapper.initializeMap("map");
//                    Console.log(get_location());
                    var g = get_location2(val, setter);
                    console.log("sending value ", val);
                    function setter (msg){

                        msg.forEach(function(entry) {
                            console.log(entry + " from within ");
                            try {
                                IPMapper.addIPMarker(entry);
                            }catch(err){
                                console.log("bad ip " + err);
                            }
                        });
                    }
                } catch(e){
                    console.log(e);
                }
            };
        </script>

    <input id="ip" name="ip" type="text" />
    <button onclick="IPMapper.addIPMarker($('#ip').val());">Geocode</button>

    <input id="regName" name="regName" type="text" />
    <button onclick="search_name($('#regName').val());">Regex Filter name</button>

    <div id="map" style="height: 600px;"></div>

    <div>

    <h2> other formatting items </h2>

        <table id="myTable" class="tablesorter">
            <thead>
            <tr>
                <th>User Name</th>
                <th>IP Address</th>
                <th>Session ID</th>
                <th>Browser Agent</th>
                <th>Login Time</th>
            </tr>
            </thead>
            <tbody>






            <!--<tr>-->
                <!--<td>Smith</td>-->
                <!--<td>John</td>-->
                <!--<td>jsmith@gmail.com</td>-->
                <!--<td>$50.00</td>-->
                <!--<td>http://www.jsmith.com</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td>Bach</td>-->
                <!--<td>Frank</td>-->
                <!--<td>fbach@yahoo.com</td>-->
                <!--<td>$50.00</td>-->
                <!--<td>http://www.frank.com</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td>Doe</td>-->
                <!--<td>Jason</td>-->
                <!--<td>jdoe@hotmail.com</td>-->
                <!--<td>$100.00</td>-->
                <!--<td>http://www.jdoe.com</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td>Conway</td>-->
                <!--<td>Tim</td>-->
                <!--<td>tconway@earthlink.net</td>-->
                <!--<td>$50.00</td>-->
                <!--<td>http://www.timconway.com</td>-->
            <!--</tr>-->
            </tbody>
        </table>
    </div>


    <div id="write"></div>
    <script type="text/javascript">
        $.ajax({
            method: "GET",
            beforeSend: function (request) {
                request.setRequestHeader("X-XSRF-TOKEN", PluginFramework.CsrfToken);
            },
            url: "plugin/geoMap/getDB"
        })
                .done(function (msg) {
                    console.log("HOLY snack!!");
                    console.log(msg);
                    <!--return msg;-->
                });
    </script>

    <!--</script>-->
    <!--<sp:script enabled="false"-->
               <!--serveOffset="#{base.requestContextPath}/#{pluginFramework.pluginFolderName}/#{pluginFramework.uniqueName}/ui/js">-->

     <!--<src>ipmapper.js</src>-->
    <!-- this works as well ^^^  -->
    <!--</sp:script>-->
    <!-- </sp:script> -->


</ui:composition>


</body>
</html>

