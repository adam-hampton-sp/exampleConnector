<div class="myMap">


<div style="height: 8px"></div>
<div id="titleo" style="display: inline">
    <div id="c1">
        <input id="ip" name="ip" type="text"/>
        <button class="cusbutton" onclick="IPMapper.addIPMarkerCustom($('#ip').val());">Geocode IP</button>
        <input id="regName" name="regName" type="text"/>
        <button class="cusbutton" onclick="IPMapper.swap_color($('#regName').val());">Mark User Name</button>
    </div>
    <div id="c2">
        <h1 class="geoTitle"> GeoCoordinate <span id="thins">Login System</span></h1>
    </div>
    <div id="c3">
        <button class="cusbutton" style="font-size: 14px !important;" ui-sref="mainMenu"><i class="fa fa-arrow-left" aria-hidden="true"></i> <span class="thinFont"> BACK </span></button>
    </div>
</div>


<!--<div id="map" style="height: 750px;"></div>-->
<div id="myMap2">
<div id="map" style="height: 85vh;"></div>

<h2 id="toggleTable" slide-toggle="#dyTable" onMouseOver="this.style.color='#258BA7'" onMouseOut="this.style.color='#000'" ><i id="rotate" class="fa fa-arrow-circle-up" style="font-size:36px"></i>  Table</h2>
<!--<h2 id="toggleTable" slide-toggle="#dyTable" onMouseOver="this.style.color='#258BA7'" onMouseOut="this.style.color='#2BA4C7'" ><i id="rotate" class="fa fa-arrow-circle-up" style="font-size:36px"></i>  Table</h2>-->
<div id="dyTable" class ="slideable" style="padding-left: 20px">
    <table id="myTable" class="table hover">
        <thead>
        <tr>
            <th>User Name</th>
            <th>Session Id</th>
            <th>IP</th>
            <th>Login Time</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>IP Header</th>
            <th>ID</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
    </div>

<script type="text/javascript">

    $(".sp-footer").hide();

    //rotate down
    var row = document.getElementById('toggleTable');
    var rotate = document.getElementById( 'rotate' );
    row.addEventListener( 'click', function () {
        if(rotate.className != 'fa fa-arrow-circle-up over') {
            rotate.className = 'fa fa-arrow-circle-up over';
        }
        else{
            rotate.className = 'fa fa-arrow-circle-up out';
        }
    }, false );
    //<![CDATA[
    $(document).ready(function(){
        try{
            IPMapper.initializeMap("map");
            //shapes first to trigger
            get_shapes(function (data) {
                IPMapper.placeShapesFromJSON(data);
            });
            getDB(function(data){
                IPMapper.placeIPMarkerFromJSON(data);
                table = $('#myTable').DataTable({
                    "bProcessing": true,
                    "fnRowCallback": function (nRow, aData, iDisplayIndex) {

                        $('td:eq(0)', nRow).html('<a href="javascript:google.maps.event.trigger(allMarkers['+ aData["ID"]+'],\'click\');">' + aData["user_name"] + '</a>');
                        // Bind click event
                        $(nRow).click(function() {
                            google.maps.event.trigger(allMarkers[aData["ID"]],'click');

                        });
                        // Bind click event
//                        $(nRow).click(function() {
//                            google.maps.event.trigger(allMarkers[aData["ID"]],'click');
//
//                        });
                        return nRow;
                    },
                    "aaData": JSON.parse(data),
                    "aoColumns": [
                        {"mData": "user_name"},
                        {"mData": "session_id"},
                        {"mData": "ip"},
                        {"mData": "login_time"},
                        {"mData": "latitude"},
                        {"mData": "longitude"},
                        {"mData": "ip_header"},
                        {"mData": "ID"}
                    ]
                });
            });
        }catch(e){
            console.log(e);
        }
    });

    var table = null;
    var selectedShape;
    function clearSelection()
    {
        if(selectedShape)
        {
            selectedShape.setEditable(false);
            selectedShape = null;
        }
    }

    var bool = false;
    $( "#toggleTable" ).click(function() {
        if (bool == false) {
            bool = !bool;
            $("#map").animate({height: "60vh"}, "slow");
        }
        else {
            setTimeout(function(){
            bool = !bool;
            $("#map").animate({height: "85vh"}, "slow");
            }, 800);
        }
    });


    function setSelection(shape)
    {
        clearSelection();
        selectedShape = shape;
        shape.setEditable(true);
    }
    //]]>
</script>
</div>