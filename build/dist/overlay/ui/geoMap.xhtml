<!DOCTYPE html PUBLIC
        "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- (c) Copyright 2016 SailPoint Technologies, Inc., All Rights Reserved. -->

<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:sp="http://sailpoint.com/ui"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:c="http://java.sun.com/jstl/core"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:t="http://myfaces.apache.org/tomahawk">

<head>
<title>GeoMap plugin</title>
</head>
<body>


<ui:composition>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyAINinHSMi1pUMLz3SyNtraGexa2yaHK3A"></script>

    <sp:style
            serveOffset="#{base.requestContextPath}/#{pluginFramework.pluginFolderName}/#{pluginFramework.uniqueName}/ui/css">
        <!--<src>ng-modalDialog.css?#{debug.revision}</src>-->
    </sp:style>

    <!--<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'></link>-->
    <link href='https://fonts.googleapis.com/css?family=Roboto:100' rel='stylesheet' type='text/css'></link>
    <div>
    <h1> GeoCoordinate <span id="thins">Login System</span></h1>
    </div>
    <sp:script enabled="false"
               serveOffset="#{base.requestContextPath}/#{pluginFramework.pluginFolderName}/#{pluginFramework.uniqueName}/ui/js">

        <src>mod.ipmapper.js</src>
        <src>queryMap.js</src>
        <src>jquery.dynatable.js</src>
        </sp:script>

        <script type="text/javascript">
            $(document).ready(function(){
                try{
                    IPMapper.initializeMap("map");
                        get_locations(function(data){
                            console.log(data + " is data in geomap page");
                            IPMapper.placeIPMarkerFromJSON("["+data+"]");
                        });
                }catch(e){
                    console.log(e);
                }
            });
        </script>

    <div style="padding-left: 5px">
    <input id="ip" name="ip" type="text"/>
    <button class="cusbutton" onclick="IPMapper.addIPMarkerCustom($('#ip').val());">Geocode</button>

    <input id="regName" name="regName" type="text"/>
    <button class="cusbutton" onclick="IPMapper.swap_color($('#regName').val());">Regex Filter name</button>
    </div>

    <div id="buffer" style="height: 3px"></div>
    <div id="map" style="height: 700px;"></div>

    <div style="padding-left: 20px">
    <!--<h2> other formatting items </h2>-->
        <table id="myTable" class="table">
            <thead>
            <tr>
                <th>uname</th>
                <th>session_id</th>
                <th>ip_address</th>
                <th>login_time</th>
                <th>lat</th>
                <th>lng</th>
                <th>ip_online</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script type="text/javascript">
        getDB(function(data){
                console.log(data + " is the data in geoPage");

            var $records = $('#json-records'), myRecords = JSON.parse(data);

            $('#myTable').dynatable({
                dataset: {
                    records: myRecords
                }
            });

        });

        //<![CDATA[
        //TODO: uncomment this!

//        $(document).ready(function(){
//            console.log("starting getDB.......");
//
//            getDB(function(data){
//                console.log("data");
//                console.log(data);
//                console.log(data[0]);
//                for(var x = 0; x < data . length; x++){
//                    console.log(data[x]['uname']);
//                }
//            });
//        });
//
//        function addElement (content) {
//            // create a new div element
//            // and give it some content
//            var newDiv = document.createElement("div");
//            var newContent = document.createTextNode(content);
//            newDiv.appendChild(newContent); //add the text node to the newly created div.
//
//            // add the newly created element and its content into the DOM
//            var currentDiv = document.getElementById("div1");
//            document.body.insertBefore(newDiv, currentDiv);
//            console.log("done???");
//        }
        //]]>
    </script>


    <!--</script>-->
    <!--<sp:script enabled="false"-->
               <!--serveOffset="#{base.requestContextPath}/#{pluginFramework.pluginFolderName}/#{pluginFramework.uniqueName}/ui/js">-->

     <!--<src>ipmapper.js</src>-->
    <!-- this works as well ^^^  -->
    <!--</sp:script>-->
    <!-- </sp:script> -->


</ui:composition>


</body>
</html>

